---
title: "My title"
author: "Bernice(Yixuan) Bao, Zheng(Zeb) Yang, Dongli Sun"
thanks: "Code and data are available at: <https://github.com/iloveyz12/US-Political-Support>."
date: "March 11, 2024"
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(palmerpenguins)
library(boot)
library(broom.mixed)
library(collapse)
library(dataverse)
library(gutenbergr)
library(janitor)
library(knitr)
library(marginaleffects)
library(modelsummary)
library(rstanarm)
library(tidybayes)
library(tidyverse)
```


# Introduction

You can and should cross-reference sections and sub-sections. We use @citeR and @rohan.

The remainder of this paper is structured as follows. @sec-data....

We use the dataset from 2022 Cooperative Election Study @ces2022. To further enable the analysis I employed the use of the package of ggplot[@ggplot2] to generate histograms.

# Data {#sec-data}

```{r}
#| echo: false
#| warning: false
#| message: false
ces2022 <-
  read_csv(
    here::here("data/raw_data/ces2022.csv"),
    col_types =
      cols(
        "votereg" = col_integer(),
        "presvote20post" = col_integer(),
        "gender4" = col_integer(),
        "educ" = col_integer()
      )
  )

ces2022 <-
  ces2022 |>
  filter(votereg == 1,
         presvote20post %in% c(1, 2)) |>
  mutate(
    voted_for = if_else(presvote20post == 1, "Biden", "Trump"),
    voted_for = as_factor(voted_for),
    gender = case_when(
      gender4 == 1 ~ "Man", 
      gender4 == 2 ~ "Woman", 
      gender4 == 3 ~ "Non-binary", 
      gender4 == 4 ~ "Other"),
    education = case_when(
      educ == 1 ~ "No HS",
      educ == 2 ~ "High school graduate",
      educ == 3 ~ "Some college",
      educ == 4 ~ "2-year",
      educ == 5 ~ "4-year",
      educ == 6 ~ "Post-grad"
    ),
    education = factor(
      education,
      levels = c(
        "No HS",
        "High school graduate",
        "Some college",
        "2-year",
        "4-year",
        "Post-grad"
      )
    )
  ) |>
  select(voted_for, gender, education)
```






Talk more about it.





Talk way more about it. 



# Model

The goal of our modelling strategy is twofold. Firstly,...


```{r}
#| echo: false
#| warning: false
#| message: false
#| include: false

set.seed(812)



ces2022_reduced <- 
  ces2022 |> 
  slice_sample(n = 1000)

political_preferences <-
  stan_glm(
    voted_for ~ gender + education,
    data = ces2022_reduced,
    family = binomial(link = "logit"),
    prior = normal(location = 0, scale = 2.5, autoscale = TRUE),
    prior_intercept = 
      normal(location = 0, scale = 2.5, autoscale = TRUE),
    seed = 853
  )

saveRDS(
  political_preferences,
  file = "political_preferences.rds"
)
```

```{r}
#| echo: false
#| warning: false
#| message: false
political_preferences <-
  readRDS(file = "political_preferences.rds")
```

```{r}
#| label: tbl-vote
#| tbl-cap: "Whether a respondent is likely to vote for Biden based on their gender and education"
#| echo: false
#| warning: false
#| message: false
modelsummary(
  list(
    "Support Biden" = political_preferences
  ),
  statistic = "mad"
  )
```



## Model set-up

Define $y_i$ as the ... Then $\beta_i$ is the ... and $\gamma_i$ is the ...

\begin{align} 
y_i|\pi_i &\sim \mbox{Bern}(\pi_i) \\
\mbox{logit}(\pi_i) &= \alpha + \beta_1 \times \mbox{gender}_i + \beta_2 \times \mbox{education}_i\\
\alpha &\sim \mbox{Normal}(0, 2.5) \\
\beta_1 &\sim \mbox{Normal}(0, 5.02) \\
\beta_2 &\sim \mbox{Normal}(0, 6.34)
\end{align}

We run the model in R [@citeR] using the `rstanarm` package of @rstanarm. We use the default priors from `rstanarm`.


### Model justification

We expect a positive relationship between .... In particular...

We can use maths by including latex between dollar signs, for instance $\theta$.


# Results

Our results are summarized in @fig-vote.

```{r}
#| label: fig-vote
#| fig-cap: "The distribution of presidential preferences, by gender, and highest education"
#| echo: false
#| eval: true
#| warning: false
#| message: false

ces2022 |>
  ggplot(aes(x = education, fill = voted_for)) +
  stat_count(position = "dodge") +
  facet_wrap(facets = vars(gender)) +
  theme_minimal() +
  labs(
    x = "Highest education",
    y = "Number of respondents",
    fill = "Voted for"
  ) +
  coord_flip() +
  scale_fill_brewer(palette = "Set1") +
  theme(legend.position = "bottom")
```



# Discussion

## First discussion point {#sec-first-point}



## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included

\newpage

\appendix

# Appendix {-}


# Additional data details

# Model details {#sec-model-details}







\newpage


# References


